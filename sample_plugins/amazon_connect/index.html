<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ID-Contact Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ID-Contact Blog Atom Feed"><title data-react-helmet="true">Amazon Connect | ID-Contact</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Amazon Connect | ID-Contact"><meta data-react-helmet="true" name="description" content="The Amazon Connect plugin is intended as a sample plugin, illustrating an approach to implement a telephony plugin. The plugin has minimal interaction required from the actual telephony flow. It consists of 3 parts, only one of which is actually specific to Amazon Connect:"><meta data-react-helmet="true" property="og:description" content="The Amazon Connect plugin is intended as a sample plugin, illustrating an approach to implement a telephony plugin. The plugin has minimal interaction required from the actual telephony flow. It consists of 3 parts, only one of which is actually specific to Amazon Connect:"><meta data-react-helmet="true" property="og:url" content="https://docs.idcontact.nl/sample_plugins/amazon_connect"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.idcontact.nl/sample_plugins/amazon_connect"><link rel="stylesheet" href="/styles.d37612c9.css">
<link rel="preload" href="/styles.86abdcb7.js" as="script">
<link rel="preload" href="/runtime~main.b554b013.js" as="script">
<link rel="preload" href="/main.f777b766.js" as="script">
<link rel="preload" href="/2.0732aa58.js" as="script">
<link rel="preload" href="/3.71af52dc.js" as="script">
<link rel="preload" href="/27.af86968c.js" as="script">
<link rel="preload" href="/935f2afb.fed1a0dc.js" as="script">
<link rel="preload" href="/17896441.30863bfd.js" as="script">
<link rel="preload" href="/0573d988.b0b155d8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">ID-Contact</strong></a><a class="navbar__item navbar__link" href="/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">ID-Contact</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Docs</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">ID Contact</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Concepts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/attributes">Attributes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/concepts/purposes">Purposes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Sessions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sessions/full">Full</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sessions/auth_during_comm">Authentication during communication</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/core_api">Core API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Authentication Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/auth/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/auth/tech_example">Sample interaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/auth/api">API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Communication Plugins</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/comm/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/comm/tech_example">Sample interaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/comm/api">API</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Sample Plugins</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/sample_plugins/amazon_connect">Amazon Connect (telephony)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sample_plugins/digid">DigiD</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/setup">Local testing setup</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">ID Contact configuration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/configuration/core">Core</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/configuration/auth_test">Authentication test plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/configuration/comm_test">Communication test plugin</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Amazon Connect</h1></header><div class="markdown"><p>The Amazon Connect plugin is intended as a sample plugin, illustrating an approach to implement a telephony plugin. The plugin has minimal interaction required from the actual telephony flow. It consists of 3 parts, only one of which is actually specific to Amazon Connect:</p><ul><li>The plugin backend, which is responsible for talking to the rest of the ID Contact ecosystem.</li><li>The attribute display, which is responsible for displaying attributes in an iframe embedded in the interface for the service employee.</li><li>The modifications to the amazon connect flow, which are responsible for capturing the DTMF code and instructing the iframe to show the correct session data.</li></ul><p>Within this design split, a call flow looks as follows:</p><ol><li>The core contacts the plugin backend to start a session.</li><li>The plugin backend generates a DTMF code, and stores that together with the session purpose in its database.</li><li>The plugin backend responds to the core with a phone URL containing the amazon connect phone number and the DTMF code, together with an attribute URL containing a session identifier.</li><li>An authentication plugin contacts the plugin backend on the previously provided session identifier with an authentication result.</li><li>The plugin backend stores this authentication result together with the session.</li><li>The end user starts calling the amazon connect phone number.</li><li>Amazon Connect answers and asks for the DTMF code.</li><li>Amazon Connect then sends that DTMF code, together with the phone session identifier to the plugin backend.</li><li>The plugin backend uses the DTMF code to find the session, and associates the phone session identifier with it.</li><li>An agent gets assigned to the phone call by Amazon Connect</li><li>The agents user interface sends the phone session identifier to the attribute display iframe</li><li>The attribute display iframe ask the plugin backend for the authentication results and displays these in the iframe.</li></ol><p>Note that the actual involvement from the phone flow that differs from a non-authenticated call is only in the reception of the DTML code and in a small modification to the agent user interface to update an iframe on agent state changes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="plugin-backend"></a>Plugin backend<a class="hash-link" href="#plugin-backend" title="Direct link to heading">#</a></h2><p>The plugin backend is the main Rust binary in the repository. It is the server that talks directly to the rest of the ID Contact ecosystem.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h3><p>The plugin backend is configured through the <a href="https://rocket.rs/master/guide/configuration/" target="_blank" rel="noopener noreferrer">rocket configuration system</a>, and is configured similarly to the <a href="/configuration/comm_test">test communication plugin</a></p><table><thead><tr><th>key</th><th>environment variable</th><th>description</th><th>default</th></tr></thead><tbody><tr><td>address</td><td>ROCKET_ADDRESS</td><td>IP address for server to use</td><td><code>127.0.0.1</code></td></tr><tr><td>port</td><td>ROCKET_PORT</td><td>Port for server to listen on</td><td><code>8000</code></td></tr><tr><td>internal_url</td><td>ROCKET_INTERNAL_URL</td><td>URL on which the server can be reached by other ID Contact components</td><td></td></tr><tr><td>workers</td><td>ROCKET_WORKERS</td><td>Number of threads to use for serving responses</td><td>cpu core count</td></tr><tr><td>keep_alive</td><td>ROCKET_KEEP_ALIVE</td><td>HTTP persistence keep alive timeout</td><td><code>5</code></td></tr><tr><td>log_level</td><td>ROCKET_LOG_LEVEL</td><td>Log level (<code>off</code>/<code>critical</code>/<code>normal</code>/<code>debug</code>)</td><td><code>normal</code></td></tr><tr><td>phonenumber</td><td>ROCKET_PHONENUMBER</td><td>Phone number of amazon connect flow</td><td></td></tr><tr><td>dtmf_length</td><td>ROCKET_DTMF_LENGTH</td><td>Number of digits in generated DTMF codes</td><td></td></tr><tr><td>result_length</td><td>ROCKET_RESULT_LENGTH</td><td>Number of characters in authentication result report code</td><td></td></tr><tr><td>decryption_privkey</td><td>ROCKET_DECRYPTION_PRIVKEY</td><td>Private key used for decrypting authentication results</td><td></td></tr><tr><td>signature_pubkey</td><td>ROCKET_SIGNATURE_PUBKEY</td><td>Public key used for verifying the signature on authentication results</td><td></td></tr></tbody></table><p>The cryptographic key parameters consists of the following subkeys specifying the actual key type and key material</p><table><thead><tr><th>key</th><th>description</th></tr></thead><tbody><tr><td>type</td><td>What type of key this is (<code>RSA</code> for RSA keys, <code>EC</code> for eliptic curve keys)</td></tr><tr><td>key</td><td>PEM encoding of the actual key</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="attribute-display"></a>Attribute display<a class="hash-link" href="#attribute-display" title="Direct link to heading">#</a></h2><p>The attribute display is a simple react application contained fully in the <code>attribute-ui</code> folder. It takes the session identifier as a query parameter and uses that to fetch authentication results from the backend and display these.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configuration-1"></a>Configuration<a class="hash-link" href="#configuration-1" title="Direct link to heading">#</a></h3><p>The attribute display code is configured through the file <code>attribute-ui/config.js</code>. This contains translations for the purpose tags in <code>window.TRANSLATIONS</code>, as well as the url on which the plugin backend can be found in <code>window.SERVER_URL</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="amazon-connect-integration"></a>Amazon Connect integration<a class="hash-link" href="#amazon-connect-integration" title="Direct link to heading">#</a></h2><p>The actual Amazon Connect integration consists of two subparts: a lambda which is called during the amazon connect flow to link the phone session identifier to the dtmf code (in <code>aws_funcs/assign_id.js</code>), and an amazon connect service center UI (in <code>amazon-connect-ui</code>).</p><p>The service center user interface is a very thin wrapper page around the amazon-connect-streams API, adding only an extra iframe to the page and some code for updating that iframe&#x27;s src attribute depending on the current session the agent is in.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configuration-2"></a>Configuration<a class="hash-link" href="#configuration-2" title="Direct link to heading">#</a></h3><p>The lambda and Amazon Connect flow must be configured through Amazon&#x27;s interfaces for this. The service center user interface has a configuration file <code>amazon-connect-ui/config.js</code> which should contain the URL of the attribute user interface in <code>AttributeURL</code>, and the Amazon Connect Streams URL as <code>AmazonConnectURL</code>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/comm/api"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Communication plugin API</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/sample_plugins/digid"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DigiD Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#plugin-backend" class="table-of-contents__link">Plugin backend</a><ul><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li></ul></li><li><a href="#attribute-display" class="table-of-contents__link">Attribute display</a><ul><li><a href="#configuration-1" class="table-of-contents__link">Configuration</a></li></ul></li><li><a href="#amazon-connect-integration" class="table-of-contents__link">Amazon Connect integration</a><ul><li><a href="#configuration-2" class="table-of-contents__link">Configuration</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/auth/overview">Authentication plugins</a></li><li class="footer__item"><a class="footer__link-item" href="/comm/overview">Communication plugins</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Tweede Golf. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.86abdcb7.js"></script>
<script src="/runtime~main.b554b013.js"></script>
<script src="/main.f777b766.js"></script>
<script src="/2.0732aa58.js"></script>
<script src="/3.71af52dc.js"></script>
<script src="/27.af86968c.js"></script>
<script src="/935f2afb.fed1a0dc.js"></script>
<script src="/17896441.30863bfd.js"></script>
<script src="/0573d988.b0b155d8.js"></script>
</body>
</html>