(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1031:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/setup_complete-6dca22c2df74de96139208d640f6ec30.png"},76:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return s})),n.d(t,"default",(function(){return u}));var a=n(3),o=n(7),r=(n(0),n(93)),i={id:"setup",title:"Setup for local testing",sidebar_label:"Local testing setup",slug:"setup"},l={unversionedId:"setup",id:"setup",isDocsHomePage:!1,title:"Setup for local testing",description:"This guide aims to provide a complete introduction to setting up a first ID Contact environment. It provides guidance on an initial setup and configuration for the core, an authentication plugin and a communication plugin.",source:"@site/docs/setup.md",slug:"/setup",permalink:"/setup",version:"current",sidebar_label:"Local testing setup",sidebar:"docs",previous:{title:"Amazon Connect",permalink:"/sample_plugins/amazon_connect"},next:{title:"Core configuration options",permalink:"/configuration/core"}},s=[{value:"Design",id:"design",children:[]},{value:"Key material",id:"key-material",children:[]},{value:"Setting up the authentication test plugin",id:"setting-up-the-authentication-test-plugin",children:[]},{value:"Setting up the communication test plugin",id:"setting-up-the-communication-test-plugin",children:[]},{value:"Setting up the core",id:"setting-up-the-core",children:[]},{value:"Testing",id:"testing",children:[]}],c={toc:s};function u(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},c,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"This guide aims to provide a complete introduction to setting up a first ID Contact environment. It provides guidance on an initial setup and configuration for the core, an authentication plugin and a communication plugin."),Object(r.b)("p",null,"The resulting setup can be used as a starting point for further experimentation with the ID Contact ecosystem. In particular, our use here of the test authentication and communication plugins makes this setup particularly well suited for as a starting point for a development environment for new ID Contact plugins."),Object(r.b)("h2",{id:"design"},"Design"),Object(r.b)("p",null,"As ID Contact is quite flexible, before we start setting up the various components we will first need to decide on what we want. In this tutorial we will make it our goal to set up a single flow, test_purpose, for which users need to reveal their test_attribute. We want to enable the test authentication plugin for this flow, as well as the test communication plugin, but won't focus on further plugins."),Object(r.b)("p",null,"Thus, we will need to setup 3 components:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The ID Contact core."),Object(r.b)("li",{parentName:"ul"},"The ID Contact authentication test plugin."),Object(r.b)("li",{parentName:"ul"},"The ID Contact communication test plugin.")),Object(r.b)("p",null,"And configure these to work with the test_purpose purpose, and the test_attribute attribute. Furthermore, as all of these are http servers, we will need to assign them ports in order to avoid conflict. We will use the following assignment:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Core: port 8000"),Object(r.b)("li",{parentName:"ul"},"Authentication test plugin: 8001"),Object(r.b)("li",{parentName:"ul"},"Communication test plugin: 8002")),Object(r.b)("h2",{id:"key-material"},"Key material"),Object(r.b)("p",null,"The authentication information exchanged between authentication and communication plugins is encrypted and signed. For this, we will need keys for the plugins to use to encrypt/decrypt and to sign/verify. These are just standard PEM encoded RSA public/private keypairs, and you can generate them yourself if you want using .e.g. openSSL."),Object(r.b)("p",null,"However, for ease of reference we provide here an RSA keypair for testing:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5/wRrT2T4GGvuQYcWjLr\n/lFe51sTV2FLd3GAaMiHN8Q/VT/XEhP/kZ6042l1Bj2VpZ2yMxv294JKwBCINc34\n8VLYd+DfkMnJ4yX9LZHK2Wke6tCWBB9mYgGjMwCNdXczbl96x1/HevaTorvk91rz\nCvzw6vV08jtprAyN5aYMU4I0/cVJwi03bh/skraAB110mQSqi1QU/2z6Hkuf7+/x\n/bACxviWCyPCd/wkXNpFhTcRlfFeyKcy0pwFx1OLCDJ1qY7oU+z1wcypeOHeiUSx\nriSHlWaT24ke+J78GGVmnCZdu/MRuun5hvgaiWxnhIBmExJY6vRuMlwkbRqOft5Q\nTQIDAQAB\n-----END PUBLIC KEY-----\n")),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDn/BGtPZPgYa+5\nBhxaMuv+UV7nWxNXYUt3cYBoyIc3xD9VP9cSE/+RnrTjaXUGPZWlnbIzG/b3gkrA\nEIg1zfjxUth34N+QycnjJf0tkcrZaR7q0JYEH2ZiAaMzAI11dzNuX3rHX8d69pOi\nu+T3WvMK/PDq9XTyO2msDI3lpgxTgjT9xUnCLTduH+yStoAHXXSZBKqLVBT/bPoe\nS5/v7/H9sALG+JYLI8J3/CRc2kWFNxGV8V7IpzLSnAXHU4sIMnWpjuhT7PXBzKl4\n4d6JRLGuJIeVZpPbiR74nvwYZWacJl278xG66fmG+BqJbGeEgGYTEljq9G4yXCRt\nGo5+3lBNAgMBAAECggEARY9EsaCMLbS83wrhB37LWneFsHOTqhjHaypCaajvOp6C\nqwo4b/hFIqHm9WWSrGtc6ssNOtwAwphz14Fdhlybb6j6tX9dKeoHui+S6c4Ud/pY\nReqDgPr1VR/OkqVwxS8X4dmJVCz5AHrdK+eRMUY5KCtOBfXRuixsdCVTiu+uNH99\nQC3kID1mmOF3B0chOK4WPN4cCsQpfOvoJfPBcJOtyxUSLlQdJH+04s3gVA24nCJj\n66+AnVkjgkyQ3q0Jugh1vo0ikrUW8uSLmg40sT5eYDN9jP6r5Gc8yDqsmYNVbLhU\npY8XR4gtzbtAXK8R2ISKNhOSuTv4SWFXVZiDIBkuIQKBgQD3qnZYyhGzAiSM7T/R\nWS9KrQlzpRV5qSnEp2sPG/YF+SGAdgOaWOEUa3vbkCuLCTkoJhdTp67BZvv/657Q\n2eK2khsYRs02Oq+4rYvdcAv/wS2vkMbg6CUp1w2/pwBvwFTXegr00k6IabXNcXBy\nkAjMsZqVDSdQByrf80AlFyEsOQKBgQDvyoUDhLReeDNkbkPHL/EHD69Hgsc77Hm6\nMEiLdNljTJLRUl+DuD3yKX1xVBaCLp9fMJ/mCrxtkldhW+i6JBHRQ7vdf11zNsRf\n2Cud3Q97RMHTacCHhEQDGnYkOQNTRhk8L31N0XBKfUu0phSmVyTnu2lLWmYJ8hyO\nyOEB19JstQKBgQC3oVw+WRTmdSBEnWREBKxb4hCv/ib+Hb8qYDew7DpuE1oTtWzW\ndC/uxAMBuNOQMzZ93kBNdnbMT19pUXpfwC2o0IvmZBijrL+9Xm/lr7410zXchqvu\n9jEX5Kv8/gYE1cYSPhsBiy1PV5HE0edeCg18N/M1sJsFa0sO4X0eAxhFgQKBgQC7\niQDkUooaBBn1ZsM9agIwSpUD8YTOGdDNy+tAnf9SSNXePXUT+CkCVm6UDnaYE8xy\nzv2PFUBu1W/fZdkqkwEYT8gCoBS/AcstRkw+Z2AvQQPxyxhXJBto7e4NwEUYgI9F\n4cI29SDEMR/fRbCKs0basVjVJPr+tkqdZP+MyHT6rQKBgQCT1YjY4F45Qn0Vl+sZ\nHqwVHvPMwVsexcRTdC0evaX/09s0xscSACvFJh5Dm9gnuMHElBcpZFATIvFcbV5Y\nMbJ/NNQiD63NEcL9VXwT96sMx2tnduOq4sYzu84kwPQ4ohxmPt/7xHU3L8SGqoec\nBs6neR/sZuHzNm8y/xtxj2ZAEw==\n-----END PRIVATE KEY-----\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Note that, since the private key of this key pair is publicly known, this particular key pair should NEVER be used outside of testing/development environments.")),Object(r.b)("h2",{id:"setting-up-the-authentication-test-plugin"},"Setting up the authentication test plugin"),Object(r.b)("p",null,"We start by setting up the authentication test plugin. First, we clone the auth-test repository into our working directory, and move to it:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/id-contact/auth-test\ncd auth-test\n")),Object(r.b)("p",null,"Next, we will need to configure this plugin. For this, we create a config file ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml")," in the auth-test directory."),Object(r.b)("p",null,"We need to tell the plugin where it is located, and on which port we want it to listen:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8001"\nport = 8001\n')),Object(r.b)("p",null,"As per our design above, we set the port to 8001 to give space for the other two servers."),Object(r.b)("p",null,"Then, we need to tell it about the attributes in our system, and what test values it should provide for them:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global.attributes]\ntest_attribute = "test_attribute_value"\n')),Object(r.b)("p",null,"You can add aditional attribute tags here with their corresponding values."),Object(r.b)("p",null,"Finally, the plugin needs to know which keys to use to encrypt and sign authentication results. For this, we will just use the example keys mentioned above."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'[global.encryption_pubkey]\ntype = "RSA"\nkey = """\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5/wRrT2T4GGvuQYcWjLr\n/lFe51sTV2FLd3GAaMiHN8Q/VT/XEhP/kZ6042l1Bj2VpZ2yMxv294JKwBCINc34\n8VLYd+DfkMnJ4yX9LZHK2Wke6tCWBB9mYgGjMwCNdXczbl96x1/HevaTorvk91rz\nCvzw6vV08jtprAyN5aYMU4I0/cVJwi03bh/skraAB110mQSqi1QU/2z6Hkuf7+/x\n/bACxviWCyPCd/wkXNpFhTcRlfFeyKcy0pwFx1OLCDJ1qY7oU+z1wcypeOHeiUSx\nriSHlWaT24ke+J78GGVmnCZdu/MRuun5hvgaiWxnhIBmExJY6vRuMlwkbRqOft5Q\nTQIDAQAB\n-----END PUBLIC KEY-----\n"""\n\n[global.signing_privkey]\ntype = "RSA"\nkey = """\n-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDn/BGtPZPgYa+5\nBhxaMuv+UV7nWxNXYUt3cYBoyIc3xD9VP9cSE/+RnrTjaXUGPZWlnbIzG/b3gkrA\nEIg1zfjxUth34N+QycnjJf0tkcrZaR7q0JYEH2ZiAaMzAI11dzNuX3rHX8d69pOi\nu+T3WvMK/PDq9XTyO2msDI3lpgxTgjT9xUnCLTduH+yStoAHXXSZBKqLVBT/bPoe\nS5/v7/H9sALG+JYLI8J3/CRc2kWFNxGV8V7IpzLSnAXHU4sIMnWpjuhT7PXBzKl4\n4d6JRLGuJIeVZpPbiR74nvwYZWacJl278xG66fmG+BqJbGeEgGYTEljq9G4yXCRt\nGo5+3lBNAgMBAAECggEARY9EsaCMLbS83wrhB37LWneFsHOTqhjHaypCaajvOp6C\nqwo4b/hFIqHm9WWSrGtc6ssNOtwAwphz14Fdhlybb6j6tX9dKeoHui+S6c4Ud/pY\nReqDgPr1VR/OkqVwxS8X4dmJVCz5AHrdK+eRMUY5KCtOBfXRuixsdCVTiu+uNH99\nQC3kID1mmOF3B0chOK4WPN4cCsQpfOvoJfPBcJOtyxUSLlQdJH+04s3gVA24nCJj\n66+AnVkjgkyQ3q0Jugh1vo0ikrUW8uSLmg40sT5eYDN9jP6r5Gc8yDqsmYNVbLhU\npY8XR4gtzbtAXK8R2ISKNhOSuTv4SWFXVZiDIBkuIQKBgQD3qnZYyhGzAiSM7T/R\nWS9KrQlzpRV5qSnEp2sPG/YF+SGAdgOaWOEUa3vbkCuLCTkoJhdTp67BZvv/657Q\n2eK2khsYRs02Oq+4rYvdcAv/wS2vkMbg6CUp1w2/pwBvwFTXegr00k6IabXNcXBy\nkAjMsZqVDSdQByrf80AlFyEsOQKBgQDvyoUDhLReeDNkbkPHL/EHD69Hgsc77Hm6\nMEiLdNljTJLRUl+DuD3yKX1xVBaCLp9fMJ/mCrxtkldhW+i6JBHRQ7vdf11zNsRf\n2Cud3Q97RMHTacCHhEQDGnYkOQNTRhk8L31N0XBKfUu0phSmVyTnu2lLWmYJ8hyO\nyOEB19JstQKBgQC3oVw+WRTmdSBEnWREBKxb4hCv/ib+Hb8qYDew7DpuE1oTtWzW\ndC/uxAMBuNOQMzZ93kBNdnbMT19pUXpfwC2o0IvmZBijrL+9Xm/lr7410zXchqvu\n9jEX5Kv8/gYE1cYSPhsBiy1PV5HE0edeCg18N/M1sJsFa0sO4X0eAxhFgQKBgQC7\niQDkUooaBBn1ZsM9agIwSpUD8YTOGdDNy+tAnf9SSNXePXUT+CkCVm6UDnaYE8xy\nzv2PFUBu1W/fZdkqkwEYT8gCoBS/AcstRkw+Z2AvQQPxyxhXJBto7e4NwEUYgI9F\n4cI29SDEMR/fRbCKs0basVjVJPr+tkqdZP+MyHT6rQKBgQCT1YjY4F45Qn0Vl+sZ\nHqwVHvPMwVsexcRTdC0evaX/09s0xscSACvFJh5Dm9gnuMHElBcpZFATIvFcbV5Y\nMbJ/NNQiD63NEcL9VXwT96sMx2tnduOq4sYzu84kwPQ4ohxmPt/7xHU3L8SGqoec\nBs6neR/sZuHzNm8y/xtxj2ZAEw==\n-----END PRIVATE KEY-----\n"""\n')),Object(r.b)("p",null,"Combined, this gives us the following for ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml"),":"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8001"\nport = 8001\n\n[global.attributes]\ntest_attribute = "test_attribute_value"\n\n[global.encryption_pubkey]\ntype = "RSA"\nkey = """\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5/wRrT2T4GGvuQYcWjLr\n/lFe51sTV2FLd3GAaMiHN8Q/VT/XEhP/kZ6042l1Bj2VpZ2yMxv294JKwBCINc34\n8VLYd+DfkMnJ4yX9LZHK2Wke6tCWBB9mYgGjMwCNdXczbl96x1/HevaTorvk91rz\nCvzw6vV08jtprAyN5aYMU4I0/cVJwi03bh/skraAB110mQSqi1QU/2z6Hkuf7+/x\n/bACxviWCyPCd/wkXNpFhTcRlfFeyKcy0pwFx1OLCDJ1qY7oU+z1wcypeOHeiUSx\nriSHlWaT24ke+J78GGVmnCZdu/MRuun5hvgaiWxnhIBmExJY6vRuMlwkbRqOft5Q\nTQIDAQAB\n-----END PUBLIC KEY-----\n"""\n\n[global.signing_privkey]\ntype = "RSA"\nkey = """\n-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDn/BGtPZPgYa+5\nBhxaMuv+UV7nWxNXYUt3cYBoyIc3xD9VP9cSE/+RnrTjaXUGPZWlnbIzG/b3gkrA\nEIg1zfjxUth34N+QycnjJf0tkcrZaR7q0JYEH2ZiAaMzAI11dzNuX3rHX8d69pOi\nu+T3WvMK/PDq9XTyO2msDI3lpgxTgjT9xUnCLTduH+yStoAHXXSZBKqLVBT/bPoe\nS5/v7/H9sALG+JYLI8J3/CRc2kWFNxGV8V7IpzLSnAXHU4sIMnWpjuhT7PXBzKl4\n4d6JRLGuJIeVZpPbiR74nvwYZWacJl278xG66fmG+BqJbGeEgGYTEljq9G4yXCRt\nGo5+3lBNAgMBAAECggEARY9EsaCMLbS83wrhB37LWneFsHOTqhjHaypCaajvOp6C\nqwo4b/hFIqHm9WWSrGtc6ssNOtwAwphz14Fdhlybb6j6tX9dKeoHui+S6c4Ud/pY\nReqDgPr1VR/OkqVwxS8X4dmJVCz5AHrdK+eRMUY5KCtOBfXRuixsdCVTiu+uNH99\nQC3kID1mmOF3B0chOK4WPN4cCsQpfOvoJfPBcJOtyxUSLlQdJH+04s3gVA24nCJj\n66+AnVkjgkyQ3q0Jugh1vo0ikrUW8uSLmg40sT5eYDN9jP6r5Gc8yDqsmYNVbLhU\npY8XR4gtzbtAXK8R2ISKNhOSuTv4SWFXVZiDIBkuIQKBgQD3qnZYyhGzAiSM7T/R\nWS9KrQlzpRV5qSnEp2sPG/YF+SGAdgOaWOEUa3vbkCuLCTkoJhdTp67BZvv/657Q\n2eK2khsYRs02Oq+4rYvdcAv/wS2vkMbg6CUp1w2/pwBvwFTXegr00k6IabXNcXBy\nkAjMsZqVDSdQByrf80AlFyEsOQKBgQDvyoUDhLReeDNkbkPHL/EHD69Hgsc77Hm6\nMEiLdNljTJLRUl+DuD3yKX1xVBaCLp9fMJ/mCrxtkldhW+i6JBHRQ7vdf11zNsRf\n2Cud3Q97RMHTacCHhEQDGnYkOQNTRhk8L31N0XBKfUu0phSmVyTnu2lLWmYJ8hyO\nyOEB19JstQKBgQC3oVw+WRTmdSBEnWREBKxb4hCv/ib+Hb8qYDew7DpuE1oTtWzW\ndC/uxAMBuNOQMzZ93kBNdnbMT19pUXpfwC2o0IvmZBijrL+9Xm/lr7410zXchqvu\n9jEX5Kv8/gYE1cYSPhsBiy1PV5HE0edeCg18N/M1sJsFa0sO4X0eAxhFgQKBgQC7\niQDkUooaBBn1ZsM9agIwSpUD8YTOGdDNy+tAnf9SSNXePXUT+CkCVm6UDnaYE8xy\nzv2PFUBu1W/fZdkqkwEYT8gCoBS/AcstRkw+Z2AvQQPxyxhXJBto7e4NwEUYgI9F\n4cI29SDEMR/fRbCKs0basVjVJPr+tkqdZP+MyHT6rQKBgQCT1YjY4F45Qn0Vl+sZ\nHqwVHvPMwVsexcRTdC0evaX/09s0xscSACvFJh5Dm9gnuMHElBcpZFATIvFcbV5Y\nMbJ/NNQiD63NEcL9VXwT96sMx2tnduOq4sYzu84kwPQ4ohxmPt/7xHU3L8SGqoec\nBs6neR/sZuHzNm8y/xtxj2ZAEw==\n-----END PRIVATE KEY-----\n"""\n')),Object(r.b)("p",null,"We are now ready to start the plugin with"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"ROCKET_CONFIG=config.toml cargo run\n")),Object(r.b)("p",null,"which will build and then run the plugin."),Object(r.b)("h2",{id:"setting-up-the-communication-test-plugin"},"Setting up the communication test plugin"),Object(r.b)("p",null,"In a second terminal in our main directory, clone and enter the directory of the test communication plugin:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/id-contact/comm-test\ncd comm-test\n")),Object(r.b)("p",null,"This plugin also needs configuration, so we make a config file ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml"),", this time in the comm-test directory."),Object(r.b)("p",null,"We again start with the basics: which port the server should use and where it is:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8002"\ninternal_url = "http://localhost:8002"\nport = 8002\n')),Object(r.b)("p",null,"As per our design above, we set the port to 8002 to give space for the other two servers."),Object(r.b)("p",null,"The only other information the communication test plugin needs are the keys to decrypt and verify authentication results. Again, using the example keys from above, we get"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'[global.signature_pubkey]\ntype = "RSA"\nkey = """\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5/wRrT2T4GGvuQYcWjLr\n/lFe51sTV2FLd3GAaMiHN8Q/VT/XEhP/kZ6042l1Bj2VpZ2yMxv294JKwBCINc34\n8VLYd+DfkMnJ4yX9LZHK2Wke6tCWBB9mYgGjMwCNdXczbl96x1/HevaTorvk91rz\nCvzw6vV08jtprAyN5aYMU4I0/cVJwi03bh/skraAB110mQSqi1QU/2z6Hkuf7+/x\n/bACxviWCyPCd/wkXNpFhTcRlfFeyKcy0pwFx1OLCDJ1qY7oU+z1wcypeOHeiUSx\nriSHlWaT24ke+J78GGVmnCZdu/MRuun5hvgaiWxnhIBmExJY6vRuMlwkbRqOft5Q\nTQIDAQAB\n-----END PUBLIC KEY-----\n"""\n\n[global.decryption_privkey]\ntype = "RSA"\nkey = """\n-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDn/BGtPZPgYa+5\nBhxaMuv+UV7nWxNXYUt3cYBoyIc3xD9VP9cSE/+RnrTjaXUGPZWlnbIzG/b3gkrA\nEIg1zfjxUth34N+QycnjJf0tkcrZaR7q0JYEH2ZiAaMzAI11dzNuX3rHX8d69pOi\nu+T3WvMK/PDq9XTyO2msDI3lpgxTgjT9xUnCLTduH+yStoAHXXSZBKqLVBT/bPoe\nS5/v7/H9sALG+JYLI8J3/CRc2kWFNxGV8V7IpzLSnAXHU4sIMnWpjuhT7PXBzKl4\n4d6JRLGuJIeVZpPbiR74nvwYZWacJl278xG66fmG+BqJbGeEgGYTEljq9G4yXCRt\nGo5+3lBNAgMBAAECggEARY9EsaCMLbS83wrhB37LWneFsHOTqhjHaypCaajvOp6C\nqwo4b/hFIqHm9WWSrGtc6ssNOtwAwphz14Fdhlybb6j6tX9dKeoHui+S6c4Ud/pY\nReqDgPr1VR/OkqVwxS8X4dmJVCz5AHrdK+eRMUY5KCtOBfXRuixsdCVTiu+uNH99\nQC3kID1mmOF3B0chOK4WPN4cCsQpfOvoJfPBcJOtyxUSLlQdJH+04s3gVA24nCJj\n66+AnVkjgkyQ3q0Jugh1vo0ikrUW8uSLmg40sT5eYDN9jP6r5Gc8yDqsmYNVbLhU\npY8XR4gtzbtAXK8R2ISKNhOSuTv4SWFXVZiDIBkuIQKBgQD3qnZYyhGzAiSM7T/R\nWS9KrQlzpRV5qSnEp2sPG/YF+SGAdgOaWOEUa3vbkCuLCTkoJhdTp67BZvv/657Q\n2eK2khsYRs02Oq+4rYvdcAv/wS2vkMbg6CUp1w2/pwBvwFTXegr00k6IabXNcXBy\nkAjMsZqVDSdQByrf80AlFyEsOQKBgQDvyoUDhLReeDNkbkPHL/EHD69Hgsc77Hm6\nMEiLdNljTJLRUl+DuD3yKX1xVBaCLp9fMJ/mCrxtkldhW+i6JBHRQ7vdf11zNsRf\n2Cud3Q97RMHTacCHhEQDGnYkOQNTRhk8L31N0XBKfUu0phSmVyTnu2lLWmYJ8hyO\nyOEB19JstQKBgQC3oVw+WRTmdSBEnWREBKxb4hCv/ib+Hb8qYDew7DpuE1oTtWzW\ndC/uxAMBuNOQMzZ93kBNdnbMT19pUXpfwC2o0IvmZBijrL+9Xm/lr7410zXchqvu\n9jEX5Kv8/gYE1cYSPhsBiy1PV5HE0edeCg18N/M1sJsFa0sO4X0eAxhFgQKBgQC7\niQDkUooaBBn1ZsM9agIwSpUD8YTOGdDNy+tAnf9SSNXePXUT+CkCVm6UDnaYE8xy\nzv2PFUBu1W/fZdkqkwEYT8gCoBS/AcstRkw+Z2AvQQPxyxhXJBto7e4NwEUYgI9F\n4cI29SDEMR/fRbCKs0basVjVJPr+tkqdZP+MyHT6rQKBgQCT1YjY4F45Qn0Vl+sZ\nHqwVHvPMwVsexcRTdC0evaX/09s0xscSACvFJh5Dm9gnuMHElBcpZFATIvFcbV5Y\nMbJ/NNQiD63NEcL9VXwT96sMx2tnduOq4sYzu84kwPQ4ohxmPt/7xHU3L8SGqoec\nBs6neR/sZuHzNm8y/xtxj2ZAEw==\n-----END PRIVATE KEY-----\n"""\n')),Object(r.b)("p",null,"Combined, this gives us the following for ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml"),":"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8002"\ninternal_url = "http://localhost:8002"\nport = 8002\n\n[global.signature_pubkey]\ntype = "RSA"\nkey = """\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA5/wRrT2T4GGvuQYcWjLr\n/lFe51sTV2FLd3GAaMiHN8Q/VT/XEhP/kZ6042l1Bj2VpZ2yMxv294JKwBCINc34\n8VLYd+DfkMnJ4yX9LZHK2Wke6tCWBB9mYgGjMwCNdXczbl96x1/HevaTorvk91rz\nCvzw6vV08jtprAyN5aYMU4I0/cVJwi03bh/skraAB110mQSqi1QU/2z6Hkuf7+/x\n/bACxviWCyPCd/wkXNpFhTcRlfFeyKcy0pwFx1OLCDJ1qY7oU+z1wcypeOHeiUSx\nriSHlWaT24ke+J78GGVmnCZdu/MRuun5hvgaiWxnhIBmExJY6vRuMlwkbRqOft5Q\nTQIDAQAB\n-----END PUBLIC KEY-----\n"""\n\n[global.decryption_privkey]\ntype = "RSA"\nkey = """\n-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDn/BGtPZPgYa+5\nBhxaMuv+UV7nWxNXYUt3cYBoyIc3xD9VP9cSE/+RnrTjaXUGPZWlnbIzG/b3gkrA\nEIg1zfjxUth34N+QycnjJf0tkcrZaR7q0JYEH2ZiAaMzAI11dzNuX3rHX8d69pOi\nu+T3WvMK/PDq9XTyO2msDI3lpgxTgjT9xUnCLTduH+yStoAHXXSZBKqLVBT/bPoe\nS5/v7/H9sALG+JYLI8J3/CRc2kWFNxGV8V7IpzLSnAXHU4sIMnWpjuhT7PXBzKl4\n4d6JRLGuJIeVZpPbiR74nvwYZWacJl278xG66fmG+BqJbGeEgGYTEljq9G4yXCRt\nGo5+3lBNAgMBAAECggEARY9EsaCMLbS83wrhB37LWneFsHOTqhjHaypCaajvOp6C\nqwo4b/hFIqHm9WWSrGtc6ssNOtwAwphz14Fdhlybb6j6tX9dKeoHui+S6c4Ud/pY\nReqDgPr1VR/OkqVwxS8X4dmJVCz5AHrdK+eRMUY5KCtOBfXRuixsdCVTiu+uNH99\nQC3kID1mmOF3B0chOK4WPN4cCsQpfOvoJfPBcJOtyxUSLlQdJH+04s3gVA24nCJj\n66+AnVkjgkyQ3q0Jugh1vo0ikrUW8uSLmg40sT5eYDN9jP6r5Gc8yDqsmYNVbLhU\npY8XR4gtzbtAXK8R2ISKNhOSuTv4SWFXVZiDIBkuIQKBgQD3qnZYyhGzAiSM7T/R\nWS9KrQlzpRV5qSnEp2sPG/YF+SGAdgOaWOEUa3vbkCuLCTkoJhdTp67BZvv/657Q\n2eK2khsYRs02Oq+4rYvdcAv/wS2vkMbg6CUp1w2/pwBvwFTXegr00k6IabXNcXBy\nkAjMsZqVDSdQByrf80AlFyEsOQKBgQDvyoUDhLReeDNkbkPHL/EHD69Hgsc77Hm6\nMEiLdNljTJLRUl+DuD3yKX1xVBaCLp9fMJ/mCrxtkldhW+i6JBHRQ7vdf11zNsRf\n2Cud3Q97RMHTacCHhEQDGnYkOQNTRhk8L31N0XBKfUu0phSmVyTnu2lLWmYJ8hyO\nyOEB19JstQKBgQC3oVw+WRTmdSBEnWREBKxb4hCv/ib+Hb8qYDew7DpuE1oTtWzW\ndC/uxAMBuNOQMzZ93kBNdnbMT19pUXpfwC2o0IvmZBijrL+9Xm/lr7410zXchqvu\n9jEX5Kv8/gYE1cYSPhsBiy1PV5HE0edeCg18N/M1sJsFa0sO4X0eAxhFgQKBgQC7\niQDkUooaBBn1ZsM9agIwSpUD8YTOGdDNy+tAnf9SSNXePXUT+CkCVm6UDnaYE8xy\nzv2PFUBu1W/fZdkqkwEYT8gCoBS/AcstRkw+Z2AvQQPxyxhXJBto7e4NwEUYgI9F\n4cI29SDEMR/fRbCKs0basVjVJPr+tkqdZP+MyHT6rQKBgQCT1YjY4F45Qn0Vl+sZ\nHqwVHvPMwVsexcRTdC0evaX/09s0xscSACvFJh5Dm9gnuMHElBcpZFATIvFcbV5Y\nMbJ/NNQiD63NEcL9VXwT96sMx2tnduOq4sYzu84kwPQ4ohxmPt/7xHU3L8SGqoec\nBs6neR/sZuHzNm8y/xtxj2ZAEw==\n-----END PRIVATE KEY-----\n"""\n')),Object(r.b)("p",null,"We are now ready to start the plugin with"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"ROCKET_CONFIG=config.toml cargo run\n")),Object(r.b)("p",null,"which will build and then run the plugin."),Object(r.b)("h2",{id:"setting-up-the-core"},"Setting up the core"),Object(r.b)("p",null,"Finally, in a third terminal, clone and enter the core's directory:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/id-contact/core\ncd core\n")),Object(r.b)("p",null,"The core already has a complete ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml"),", but it is not suitable for our needs, so we will replace it."),Object(r.b)("p",null,"First, we again tell the server what port to use and where it is:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8000"\ninternal_url = "http://localhost:8000"\nport = 8000\n')),Object(r.b)("p",null,"Next, we need to give it an internal secret. This is used to temporarily sign session data so that end users cannot manipulate that. Here we just use a simple test value."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'internal_secret = "sample_secret_12345678901234567890"\n')),Object(r.b)("p",null,"Next, we need to tell the core about our authenticaton method:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[[global.auth_methods]]\ntag = "auth_test"\nname = "Test Authenticator"\nimage_path = ""\nstart = "http://localhost:8001"\n')),Object(r.b)("p",null,"and our communication method:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'[[global.comm_methods]]\ntag = "comm_test"\nname = "Test Communicator"\nimage_path = ""\nstart = "http://localhost:8002"\n\n')),Object(r.b)("p",null,"If we wanted to add more of these, we would just repeat with more plugin blocks. We leave the image paths empty here as we won't need them for our testing."),Object(r.b)("p",null,"Finally, we need to specify our purpose and how its flow should look:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[[global.purposes]]\ntag = "test_purpose"\nattributes = [ "test_attribute" ]\nallowed_auth = [ "auth_test" ]\nallowed_comm = [ "comm_test" ]\n')),Object(r.b)("p",null,"Combined, this gives as content of ",Object(r.b)("inlineCode",{parentName:"p"},"config.toml"),":"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-toml"},'[global]\nserver_url = "http://localhost:8000"\ninternal_url = "http://localhost:8000"\nport = 8000\ninternal_secret = "sample_secret_12345678901234567890"\n\n[[global.auth_methods]]\ntag = "auth_test"\nname = "Test Authenticator"\nimage_path = ""\nstart = "http://localhost:8001"\n\n[[global.comm_methods]]\ntag = "comm_test"\nname = "Test Communicator"\nimage_path = ""\nstart = "http://localhost:8002"\n\n[[global.purposes]]\ntag = "test_purpose"\nattributes = [ "test_attribute" ]\nallowed_auth = [ "auth_test" ]\nallowed_comm = [ "comm_test" ]\n')),Object(r.b)("p",null,"We are now ready to start the core with"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"ROCKET_CONFIG=config.toml cargo run\n")),Object(r.b)("p",null,"which will build and then run the core with our above configuration."),Object(r.b)("h2",{id:"testing"},"Testing"),Object(r.b)("p",null,"We can now test our setup by opening a 4th terminal window and using ",Object(r.b)("a",{parentName:"p",href:"https://httpie.io/"},"httpie")," to make a test request to the core with the intent to start a session with the testing plugins for our test_purpose:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-bash"},"http POST http://localhost:8000/start purpose=test_purpose auth_method=auth_test comm_method=comm_test\n")),Object(r.b)("p",null,"This will show our server response, containing the client url:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-http"},'HTTP/1.1 200 OK\ncontent-length: 149\ncontent-type: application/json\ndate: Tue, 13 Apr 2021 12:48:40 GMT\nserver: Rocket\n\n{\n    "client_url": "http://localhost:8001/browser/WyJ0ZXN0X2F0dHJpYnV0ZSJd/aHR0cDovL2xvY2FsaG9zdDo4MDAyL3Vp/aHR0cDovL2xvY2FsaG9zdDo4MDAyL2F1dGhfcmVzdWx0"\n}\n\n')),Object(r.b)("p",null,"Opening this url in a browser will result in a redirect, which lands you on the test plugin ui:"),Object(r.b)("p",null,Object(r.b)("img",{alt:"Browser showing communication test plugin ui",src:n(1031).default})),Object(r.b)("p",null,"Meanwhile, the communication test plugin will have logged the decoded authentication result, which will look like"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'Decoded: AuthResult { status: Succes, attributes: Some({"test_attribute": "test_attribute_value"}), session_url: None }\n')),Object(r.b)("p",null,"Congratulations! Seeing the above indicates that your setup now works correctly. You can experiment further by looking at the configuration options described in the ",Object(r.b)("a",{parentName:"p",href:"/configuration/auth_test"},"authentication test plugin")," and ",Object(r.b)("a",{parentName:"p",href:"/configuration/comm_test"},"communication test plugin")," documentation."))}u.isMDXComponent=!0},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),u=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},h=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=a,g=p["".concat(i,".").concat(h)]||p[h]||b[h]||r;return n?o.a.createElement(g,l(l({ref:t},c),{},{components:n})):o.a.createElement(g,l({ref:t},c))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}h.displayName="MDXCreateElement"}}]);