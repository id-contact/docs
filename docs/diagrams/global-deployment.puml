@startuml
title ID-contact Core Global deployment v0.3
skinparam rectangle {
    roundCorner<<Auth plugin>> 25
}

skinparam rectangle {
    roundCorner<<Comm plugin>> 10
}

actor Citizen as citizen
actor Agent as agent

rectangle "ID contact" {
    rectangle "Core widget" as core_widget
    rectangle "Matrix Widget" as matrix_widget
    cloud backend {
        rectangle "Core" as core
        rectangle "IRMA" <<Auth plugin>> as auth_irma
        rectangle "DigiD Routeringsvoorziening" <<Auth plugin>> as auth_digid

        rectangle "Amazon Connect" <<Comm plugin>> as comm_connect
        rectangle "Matrix" <<Comm plugin>> as comm_matrix
    }
}

rectangle "Matrix client" as matrix_client
rectangle "Connect client" as connect_client
rectangle "IRMA UI" as irma
rectangle "DigiD UI" as digid

citizen<-->core_widget
citizen<-r->irma
citizen<-r->digid
citizen<-->matrix_widget

agent<-->connect_client
agent<-->matrix_client

core_widget<-->core
auth_digid<-->core
auth_irma<-->core
comm_matrix<-u->core
comm_connect<-u->core

digid<->auth_digid
irma<->auth_irma

matrix_client<-->comm_matrix
matrix_widget<--->comm_matrix
connect_client<-->comm_connect

@enduml